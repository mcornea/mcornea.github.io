<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>HSRP Timers tuning and Authentication</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">        
        <meta name="description" content="Harmony is a free responsive jekyll theme by Gayan Virajith and Maheshika Lakmali. Sourced on Github -  https://github.com/gayanvirajith/harmony
">
        <link rel="canonical" 
        href="https://remote-lab.net//hsrp-timers-tuning-and-authentication">
        
        <!-- Harmony styles -->
        <link rel="stylesheet" type="text/css" href="https://remote-lab.net/assets/css/main.css">

        <!-- Modernizr js -->
        <script async src="https://remote-lab.net/assets/js/modernizr.js"></script>    

        <!-- IE Fixes -->
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->        
    </head>
    <body class="theme-base-01">
        <header class="main-header">
            <div class="wc-container">
                <h1><a href="https://remote-lab.net/">remote-lab.net</a></h1>
                <h2>learn by doing</h2>
                <ul>
	<li>
		<a href="https://remote-lab.net">Home</a><span>/</span>
	</li>
	<li>
		<a href="https://remote-lab.net//about">About</a><span>/</span>
	</li>
	<li>
		<a href="https://remote-lab.net//blog">Blog</a><span>/</span>
	</li>
	<li>
		<a href="https://compute.remote-lab.net" target="_blank">Compute</a><span>/</span>
	</li>
</ul>
                
            </div>
        </header>
        <div class="page-content wc-container">
	
	<div class="post">
		<h1>HSRP Timers tuning and Authentication</h1>
		<p class="post-meta">
			
      <span class="categories">
      switching and routing
      </span> |
	    
	    <span class="post-date">
    	Feb 22, 2012 
	    </span>
		</p>		
		<div class="post">
			<p>In today’s post we are going to continue with some HSRP implementations. We have the following topology consisting of 2 x L3 switches, 1 x L2 switch and 2 hosts located in 2 separate VLANs. On the L2 switch ports Fa0/3 and Fa0/4 are set as access ports and ports Fa0/1 and Fa0/2 are set as trunks. Also Fa0/1 on the 2 x L3 switches are set as trunks. On the L3 switches we’ll also need to set 2 SVIs used for routing between the 2 vlans we have in place.</p>

<hr />

<p><img class="aligncenter size-large wp-image-125" title="HSRP2" src="https://remote-lab.net/assets/static/HSRP2-1024x822.png" alt="" width="550" height="441" /></p>

<p>Going forward to the actual HSRP configuration, we’ll set HSRP group 0 for both the SVIs configured on the L3 switches. By default the active router in the HSRP group sends hello messages once every 3 seconds. The standby router is listening and if the hellos are missed for the duration of the holdtime timer ( 10 seconds by default ) the standby router is free to asume its active role. So this implies a 10 seconds downtime if one of the routers goes down which is unacceptable in todays networks. In order to avoid this kind of situation, we’ll set the hello messages to be sent once every 200ms and the holdtimer to be 600ms so that the actual downtime will be less than a second. This will increase the bandwidth usage for the control plane messages but I don’t think this should be a problem for nowadays links.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">interface Vlan10
 ip address 192.168.10.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.10.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
end
interface Vlan20
 ip address 192.168.20.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.20.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
end</code></pre></div>

<p>In order to prevent unathorized routers to become part of the HSRP group we need to set an authentication method for the participating devices. You can implement either a plain text or a MD5 authentication method for the HSRP group. With the plain text authentication HSRP messages are sent containing a plain text key string. If the key string in a message matches they key configured on the HSRP router then the message is accepted. With the MD5 authentication a message digest 5 hash value is sent along with the HSRP messages. This value is calculated based on a portion of the message using a secret key string. When the message is received the router recalculates the hash function of the received message and if it matches the hash value received within that message then it’s accepted. MD5 authentication is recommended as it’s far more secure than the plain text authentication. While when using the plain text authentication messages can be sniffed and the actual key string can be seen in the message, with MD5 it’s extremely difficult to reverse the hash value.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">###############PLAIN TEXT AUTHENTICATION##################</span>
interface Vlan10
 ip address 192.168.10.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.10.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
 standby <span class="m">0</span> authentication text AUTH_KEY
!
interface Vlan20
 ip address 192.168.20.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.20.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
 standby <span class="m">0</span> authentication text AUTH_KEY
end
<span class="c">########## MD5 Authentication########################</span>
interface Vlan10
 ip address 192.168.10.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.10.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
 standby <span class="m">0</span> authentication md5 key-string AUTH_KEY
end
interface Vlan20
 ip address 192.168.20.2 255.255.255.0
 standby <span class="m">0</span> ip 192.168.20.1
 standby <span class="m">0</span> timers msec <span class="m">200</span> msec 600
 standby <span class="m">0</span> authentication md5 key-string AUTH_KEY
end</code></pre></div>

<p>You may see in the following captured packets that the plain text key actually appears in the HSRP header, while when using MD5 auth part of the payload is hased using the key string</p>

<p>Plain text auth
<a href="https://remote-lab.net/assets/static/plain_text_auth.png"><img class="size-large wp-image-126 aligncenter" title="plain_text_auth" src="https://remote-lab.net/assets/static/plain_text_auth.png" alt="" width="550" height="275" /></a></p>

<p>MD5 Auth
<a href="https://remote-lab.net/assets/static/md5auth.png"><img class="size-large wp-image-127 aligncenter" title="md5auth" src="https://remote-lab.net/assets/static/md5auth.png" alt="" width="550" height="270" /></a></p>

		</div>
	</div>


	
	<div class="related">
		<h4>Related Posts</h2>
		<ul class="posts">
		    
		    <li>
			  <span>05 Apr 2015 &raquo;</span>
			  <a href="https://remote-lab.net//getting-started-with-docker">Getting started with Docker and the wonders of Open Source</a>
		    </li>
		    
		    <li>
			  <span>24 Feb 2015 &raquo;</span>
			  <a href="https://remote-lab.net//opsf-on-ios-with-ansible">OSPF lab provisioning on IOS with Ansible</a>
		    </li>
		    
		    <li>
			  <span>12 Oct 2014 &raquo;</span>
			  <a href="https://remote-lab.net//sdn-intro-basic-with-ovs-and-pox">SDN Intro: Basic L2 connectivity by using OVS and POX</a>
		    </li>
		    
		</ul>
	</div>
	

	<div class="post-footer">
		<div class="column-1">
			
				<a href="https://remote-lab.net//hot-standby-routing-protocol-hsrp-introduction"><< Older</a>
			
		</div>
		<div class="column-2"><a href="https://remote-lab.net// ">Home</a></div>
		<div class="column-3">
			
				<a href="https://remote-lab.net//debug-cisco-3g-modem">Newer >></a>
			
		</div>
	</div>
</div>
 

        <footer class="main-footer">
            <div class="wc-container">
                <div class="column one">
                    <h6>Few more links</h6>
<ul class="menu">
    <li><a href="https://remote-lab.net//about">About</a></li>
    <li><a href="https://remote-lab.net//blogroll">Blogroll</a></li>
</ul>		
                    
                </div>
                <div class="column two">
                    <h6>Follow me</h6>

<ul class="social-media">


    
    <li>
        <a title="remoteur on Twitter" 
            href="https://twitter.com/remoteur" 
            class="twitter wc-img-replace" target="_blank">Twitter</a>
    </li>   
    

    
    <li>
        <a title="remoteur on Github" 
            href="https://github.com/remoteur" 
            class="github wc-img-replace" target="_blank">Github</a>
    </li>
     

    
    <li>
        <a title="marius.catalin.31542 on Facebook" 
            href="https://facebook.com/marius.catalin.31542" 
            class="facebook wc-img-replace" target="_blank">Facebook</a>
    </li>
    

    

    

    

</ul>
                </div>
            </div>
            <p class="wc-container disclaimer">
                
Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>
            </p>
        </footer>
        <script type="text/javascript">
          /* To avoid render blocking css */
          var cb = function() {
            var l = document.createElement('link'); l.rel = 'stylesheet';
            l.href = 'https://fonts.googleapis.com/css?family=Ubuntu+Mono&subset=latin';
            var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
          };
          var raf = requestAnimationFrame || mozRequestAnimationFrame ||
              webkitRequestAnimationFrame || msRequestAnimationFrame;
          if (raf) raf(cb);
          else window.addEventListener('load', cb);
        </script>
        <!-- jQuery -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- When no internet load JQuery from local -->
        <script>window.jQuery || document.write('<script src="https://remote-lab.net//assets/js/jquery.min.js"><\/script>')</script>
        <!-- Site js -->
        <script src="https://remote-lab.net/assets/js/all.js"></script>
        <!-- Google analytics  -->
        
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxx-x']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

    </body>        
</html>
