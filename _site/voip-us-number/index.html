<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Free US local number pointed to your Cisco VoIP gateway</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">        
        <meta name="description" content="remote-lab.net learn by doing Linux and networking tutorials https://remote-lab.net
">
        <link rel="canonical" 
        href="https://remote-lab.net//voip-us-number">
        
        <!-- Harmony styles -->
        <link rel="stylesheet" type="text/css" href="https://remote-lab.net/assets/css/main.css">

        <!-- Modernizr js -->
        <script async src="https://remote-lab.net/assets/js/modernizr.js"></script>    

        <!-- IE Fixes -->
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->        
    </head>
    <body class="theme-base-01">
        <header class="main-header">
            <div class="wc-container">
                <h1><a href="https://remote-lab.net/">remote-lab.net</a></h1>
                <h2>learn by doing</h2>
                <ul>
	<li>
		<a href="https://remote-lab.net">Home</a><span>/</span>
	</li>
	<li>
		<a href="https://remote-lab.net//about">About</a><span>/</span>
	</li>
	<li>
		<a href="https://remote-lab.net//blog">Blog</a><span>/</span>
	</li>
	<li>
		<a href="https://compute.remote-lab.net" target="_blank">Compute</a><span>/</span>
	</li>
	<li>
		<a href="https://remote-lab.net//docs">Docs</a><span>/</span>
	</li>
</ul>
                
            </div>
        </header>
        <div class="page-content wc-container">
	
	<div class="post">
		<h1>Free US local number pointed to your Cisco VoIP gateway</h1>
		<p class="post-meta">
			
      <span class="categories">
      voice and ios
      </span> |
	    
	    <span class="post-date">
    	Nov 20, 2011 
	    </span>
		</p>		
		<div class="post">
			<p>In today’s post I will show how to get a free US DID - a local number and point it to your VoIP network. For this setup I will use an analog phone plugged into a FXS port of a Cisco 1751-V router. The use of a voice router isn’t necessary, you may also use an ATA - Analog Telephone Adapter.
<img class="aligncenter size-full wp-image-90" title="Diagram1" src="https://remote-lab.net/assets/static/Diagram1.png" alt="" width="286" height="360" /></p>

<hr />

<p>So now let’s get to the steps involved in having this done:</p>

<ul>
  <li>
    <p>Go to <a href="http://www.ipkall.com/">http://www.ipkall.com/</a> , sign up and you will receive your DID by email. After receiving the email you should login and change the SIP Phone Number to whatever number you’d like to send to your SIP server. Also the SIP Proxy must match your server’s IP address used for receiving the calls, in my case this will be the Cisco 1751 voice gateway.</p>
  </li>
  <li>Configure the voice router:
In order to have the calls completed you must tell the router what to do when receiving a calls:</li>
  <li>Create an inbound voip dial-peer:</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">dial-peer voice <span class="m">1</span> voip
 destination-pattern .T
 session protocol sipv2
 codec g711ulaw</code></pre></div>

<ul>
  <li>Create a pots dial-peer which routes the calls made to 2064248860 - the DID I received from IPKall - on the analog voice port 2/0:</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">dial-peer voice <span class="m">2</span> pots
 destination-pattern 2064248860
 port 2/0</code></pre></div>

<ul>
  <li>Forward the signaling and media ports to the voice gateway:
I am using NAT for my home network so I will have to set the 871 router to forward all the packets coming on the SIP signaling port UDP 5060 and also the RTP media ports - which is the UDP range between 8000 and 32000 to the voice gateway.</li>
  <li>Create an access list which matches the SIP signaling and the RTP media ports:</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ip access-list extended SIP-RTP
 permit udp any any eq 5060
 permit udp any any range <span class="m">8000</span> 30000</code></pre></div>

<ul>
  <li>Create a route map policy which uses the access list created earlier:</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">route-map SIP-RTP permit 10
 match ip address SIP-RTP</code></pre></div>

<ul>
  <li>Create a static inside NAT entry which matches the ports and translates the private address of the voice gateway to the public address</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ip nat inside <span class="nb">source </span>static 10.0.0.10 86.106.164.150 route-map SIP-RTP extendable</code></pre></div>

<p>And that should do it, I now have a local US number ringing back to my home phone in Bucharest without any charges :)</p>

		</div>
	</div>


	
	<div class="related">
		<h4>Related Posts</h2>
		<ul class="posts">
		    
		    <li>
			  <span>05 Apr 2015 &raquo;</span>
			  <a href="https://remote-lab.net//getting-started-with-docker">Getting started with Docker and the wonders of Open Source</a>
		    </li>
		    
		    <li>
			  <span>24 Feb 2015 &raquo;</span>
			  <a href="https://remote-lab.net//opsf-on-ios-with-ansible">OSPF lab provisioning on IOS with Ansible</a>
		    </li>
		    
		    <li>
			  <span>12 Oct 2014 &raquo;</span>
			  <a href="https://remote-lab.net//sdn-intro-basic-with-ovs-and-pox">SDN Intro: Basic L2 connectivity by using OVS and POX</a>
		    </li>
		    
		</ul>
	</div>
	

	<div class="post-footer">
		<div class="column-1">
			
				<a href="https://remote-lab.net//startup-script-in-ubuntu"><< Older</a>
			
		</div>
		<div class="column-2"><a href="https://remote-lab.net// ">Home</a></div>
		<div class="column-3">
			
				<a href="https://remote-lab.net//virtualbox-web-interface">Newer >></a>
			
		</div>
	</div>
</div>
 

        <footer class="main-footer">
            <div class="wc-container">
                <div class="column one">
                    <h6>Few more links</h6>
<ul class="menu">
    <li><a href="https://remote-lab.net">Home</a></li>
    <li><a href="https://remote-lab.net//about">About</a></li>
    <li><a href="https://remote-lab.net//blogroll">Blogroll</a></li>
    <li><a href="https://remote-lab.net//docs">Docs</a></li>
</ul>		
                    
                </div>
                <div class="column two">
                    <h6>Follow me</h6>

<ul class="social-media">


    
    <li>
        <a title="remoteur on Twitter" 
            href="https://twitter.com/remoteur" 
            class="twitter wc-img-replace" target="_blank">Twitter</a>
    </li>   
    

    
    <li>
        <a title="remoteur on Github" 
            href="https://github.com/remoteur" 
            class="github wc-img-replace" target="_blank">Github</a>
    </li>
     

    
    <li>
        <a title="marius.catalin.31542 on Facebook" 
            href="https://facebook.com/marius.catalin.31542" 
            class="facebook wc-img-replace" target="_blank">Facebook</a>
    </li>
    

    

    

    

</ul>
                </div>
            </div>
            <p class="wc-container disclaimer">
                
Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>
            </p>
        </footer>
        <script type="text/javascript">
          /* To avoid render blocking css */
          var cb = function() {
            var l = document.createElement('link'); l.rel = 'stylesheet';
            l.href = 'https://fonts.googleapis.com/css?family=Ubuntu+Mono&subset=latin';
            var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
          };
          var raf = requestAnimationFrame || mozRequestAnimationFrame ||
              webkitRequestAnimationFrame || msRequestAnimationFrame;
          if (raf) raf(cb);
          else window.addEventListener('load', cb);
        </script>
        <!-- jQuery -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- When no internet load JQuery from local -->
        <script>window.jQuery || document.write('<script src="https://remote-lab.net//assets/js/jquery.min.js"><\/script>')</script>
        <!-- Site js -->
        <script src="https://remote-lab.net/assets/js/all.js"></script>
        <!-- Google analytics  -->
        
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxx-x']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

    </body>        
</html>
